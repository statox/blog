<!DOCTYPE html>
<html lang="en">
<title>Winter holidays unfinished projects (1/2) - Triomino - The stuff I do</title>

<meta name="description" content="A personal blog where I write about my side projects">
<meta name="robots" content="index,follow">
<meta name="author" content="statox">

<link rel="canonical" href="https://www.statox.fr/posts/p5/winter-holiday-2020/triomino/">

<meta property="og:title" content="Winter holidays unfinished projects (1/2) - Triomino - The stuff I do">
<meta property="og:type" content="article">

<meta property="og:url" content="https://www.statox.fr/posts/p5/winter-holiday-2020/triomino/">
<meta property="og:description" content="A personal blog where I write about my side projects">


<meta name="twitter:card" content="summary">

<meta name="twitter:url" content="https://www.statox.fr/posts/p5/winter-holiday-2020/triomino/">
<meta name="twitter:title" content="Winter holidays unfinished projects (1/2) - Triomino - The stuff I do">
<meta name="twitter:description" content="A personal blog where I write about my side projects">



<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Winter holidays unfinished projects (1/2) - Triomino</title>
    <meta name="description" content="A personal blog where I write about my side projects">
    <meta name="keywords" content="statox blog">
    <meta property="og:title" content="The stuff I do">
    <meta property="og:url" content="https://www.statox.fr">
    <meta property="og:description" content="A personal blog where I write about my side projects">
    <meta property="og:type" content="website">

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/open-fonts@1.1.1/fonts/inter.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">

    
    <link rel="stylesheet" href="https://unpkg.com/prismjs@1.20.0/themes/prism-tomorrow.css">

    
    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/navbar.css">
    <link rel="stylesheet" href="/css/material.css">
    <link rel="stylesheet" href="/css/comments.css">

    

    

    

    

    
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
    <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#5bbad5">

    <script>
        function navbarToggle() {
            var x = document.getElementById("header-navbar");
            if (x.className === "topnav") {
                x.className += " responsive";
            } else {
                x.className = "topnav";
            }
        }
    </script>
</head>
<body>
    <header>
        <h1>The stuff I do</h1>
        <!--
           - Make the whole navbar clickable: It doesn't change anything on desktop
           - and makes it easier to open the menu on mobile
           -->
        <nav class="topnav" id="header-navbar" onclick="navbarToggle()">
            
            
            

            
                
                
                
                
                <span class="nav-item ">
                    <a class="nav-link " href="/">Home</a>
                    <i class="nav-separator"> ♢ </i>
                </span>
                
                
                
                
                
                <span class="nav-item ">
                    <a class="nav-link " href="/coolcovers/">Cool covers</a>
                    <i class="nav-separator"> ♢ </i>
                </span>
                
                
                
                
                
                <span class="nav-item ">
                    <a class="nav-link " href="/notes/">Notes</a>
                    <i class="nav-separator"> ♢ </i>
                </span>
                
                
                
                
                
                <span class="nav-item ">
                    <a class="nav-link " href="/about/">About</a>
                    <i class="nav-separator"> ♢ </i>
                </span>
                
                
                
                
                
                <span class="nav-item ">
                    <a class="nav-link " href="/social/">Social</a>
                    <i class="nav-separator"> ♢ </i>
                </span>
                
                
                
                
                
                <span class="nav-item ">
                    <a class="nav-link " href="/ring/">Ring</a>
                    <i class="nav-separator"> ♢ </i>
                </span>
                
                
                
                
                
                <span class="nav-item ">
                    <a class="nav-link " href="/feed.xml">RSS</a>
                    <i class="nav-separator"></i>
                </span>
                

                
                <span class="icon hamburger" onclick="navbarToggle()"> </span>
        </nav>
    </header>

    

    <div class="content-container">
        
<h2>Winter holidays unfinished projects (1/2) - Triomino</h2>
<p class="post-subheader">
    January 20, 2021
    - 889 words
    - <span id="commentCounter"></span> comments

</p>
<p><a href="/">← Posts</a></p>

<h3>Board games are fun!</h3>
<p>During the winter holidays I played some games of Triomino and Reversi, which I hadn't done in an eternity. This reminded me that the first programs I enjoyed coding were some board games and it gave me the motivation to get back on some side projects.</p>
<p>So once again I cloned my boilerplate git repo with an html page and the p5.js library imported and started coding.</p>
<p>Even though I didn't finished any of these projects they were still fun to work on and worth a short blogpost, for the posterity.</p>
<h3>Triomaster</h3>
<p>As the name of the project suggest I was aiming for an IA mastering the Triomino game... I ended up with an IA playing the Triomino game.</p>
<p>When I started thinking about this project I had in mind a <a href="http://www-cs-students.stanford.edu/~amitp/game-programming/grids/" target="_blank" rel="noopener noreferrer">great article on redblobgame</a> about different kind of grids and how to implement them I had read several months ago and thought it would be useful. But being impatient to start coding I went straight in and didn't read it again, probably making some mistakes which I could have avoided.</p>
<p><img src="./triomino.png" alt="Screenshot of my Triomino implementation"></p>
<center>
    <i>Another obvious proof of my UX/UI designer genius</i>
</center>
<h4>Grid system</h4>
<p>I ended up with a two dimensional array containing consecutive <code>Cell</code> objects. These objects have a <code>pointsDown</code> property set at the creation of the grid and used to determine how the tile is displayed (pointing up or down). When a tile is placed on it, the object also has a reference to a <code>Triomino</code> object holding the actual values of the tile and which is responsible for checking which other triominos are allowed to connect or not. With a bit of math (and a lot of poking around to find the correct formula) I was able to show triangles adjacent one to another pointing alternatively up and down.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">show</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">stroke</span><span class="token punctuation">(</span><span class="token string">'rgba(0, 0, 0, 0.1)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">strokeWeight</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">noFill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Show the user which cell is clicked</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>selected<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token function">fill</span><span class="token punctuation">(</span><span class="token string">'rgba(50, 200, 50, 0.3)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Move to the right position and rotate to point up</span><br>    <span class="token function">translate</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>pos<span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pos<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// If needed rotate again to point down and translate so that we are aligned with those pointing up</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>pointsDown<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token function">translate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token keyword">this</span><span class="token punctuation">.</span>r <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token function">rotate</span><span class="token punctuation">(</span><span class="token constant">PI</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>    <span class="token function">rotate</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Draw the triangle shape</span><br>    <span class="token function">beginShape</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">vertex</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>r<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">vertex</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>r <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> <span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>r <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> <span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">vertex</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>r <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>r <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">endShape</span><span class="token punctuation">(</span><span class="token constant">CLOSE</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>triomino<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">this</span><span class="token punctuation">.</span>triomino<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p>Things got messy when I finished displaying the triangles and started thinking about how to click on them (to select the triomino to play and where to place it). I didn't felt like doing the math to determine when the mouse is in a particular triangle, so I thought I would be smart and lazy using the <a href="https://molleindustria.github.io/p5.play/" target="_blank" rel="noopener noreferrer">p5play</a> library. It provides the ability to create some sprites and to attach an event when the sprite is clicked, offloading the burden of calculating mouse-to-sprite collisions. I choose to go quick and dirty, adding a <code>Sprite</code> object to each <code>Cell</code> and <code>Triomino</code> objects with nothing in the <code>draw()</code> function of the <code>Sprite</code> because I already had a nice <code>draw()</code> function in the <code>Cell</code>. Of course after several iterations when the project got more complex it just added more complexity and was probably not the smartest choice.</p>
<p>One of the main issue was to keep the <code>Sprite</code> position synced with its parent object position (mainly because I handled the <code>Triomino</code> moves terribly). After some tweaks it ended up working.</p>
<h4>AI</h4>
<p>At first I wanted to go with a clever AI which would use some kind of A* algorithm to find the best possible move to do.  However my first AI version was much simpler: Looking for all the possible moves and placing the triomino with the highest score.</p>
<p>To have a working AI I needed to implement the <a href="https://www.pressmantoy.com/wp-content/uploads/2018/01/Tri-Ominos.pdf" target="_blank" rel="noopener noreferrer">complete set of scoring rules</a>, but I only implemented the basic rule of &quot;when the player places a tile her score is incremented by the sum of the digits on the tile&quot; and the bonus points at the beginning of the game. I didn't implemented the bonus points granted when a shape is completed.</p>
<p>So given my incomplete set of rules I played a few game against my basic AI and I realized that it is still pretty good, actually as good as a human who would play the game for the first time without thinking of the strategy but never missing a possible spot.</p>
<p>After these few games I realized that Triomino quickly gets boring and that luck is a big factor anyway so I decided to switch to my next project.</p>
<h4>Online demo</h4>
<p>I'm still happy with the result of this project: One can play a complete game against the computer, the scores are kept track of and a winner is declared before the game starts again.</p>
<p>There are still a tons of features which I would want to add, especially the ability to scroll over the board to avoid being blocked by its small dimension but the way I handled sprites makes it pretty hard to do and that would probably require a complete refactoring.</p>
<p>A demo is hosted on github pages and available <a href="https://statox.github.io/triomaster/" target="_blank" rel="noopener noreferrer">here</a> and the code is <a href="https://github.com/statox/triomaster" target="_blank" rel="noopener noreferrer">on Github</a>.</p>


<p><a href="/">← Posts</a></p>

<hr>
<comments>
    <h3>Comments</h3>
    <a class="add-comment-btn" href="https://github.com/statox/blog-comments/issues/17#new_comment_field"  target="_blank" rel="noopener noreferrer">
        <button>Comment on Github</button>
    </a>
    <br>
</comments>

<script type="text/javascript" src="/scripts/githubComments.js"></script>
<script type="text/javascript">
    setupCommentsInPage(17);
</script>

    </div>

    <script data-goatcounter="https://statoxblog.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
    <script async defer src="https://api.newcss.net/latest.js"></script>
    <noscript><img src="https://api.newcss.net/noscript.gif" alt=""></noscript>
</body>
</html>
