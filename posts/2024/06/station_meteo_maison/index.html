<!doctype html><html lang="en"><title>Capteurs environnementaux maison - The stuff I do</title><meta name="description" content="A personal blog where I write about my side projects"/><meta name="robots" content="index,follow"/><meta name="author" content="[object Object]"/><link rel="canonical" href="https://www.statox.fr/posts/2024/06/station_meteo_maison/"/><meta property="og:title" content="Capteurs environnementaux maison - The stuff I do"/><meta property="og:type" content="article"/><meta property="og:url" content="https://www.statox.fr/posts/2024/06/station_meteo_maison/"/><meta property="og:description" content="A personal blog where I write about my side projects"/><meta name="twitter:card" content="summary"/><meta name="twitter:url" content="https://www.statox.fr/posts/2024/06/station_meteo_maison/"/><meta name="twitter:title" content="Capteurs environnementaux maison - The stuff I do"/><meta name="twitter:description" content="A personal blog where I write about my side projects"/><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Capteurs environnementaux maison</title><meta name="description" content="A personal blog where I write about my side projects"/><meta name="keywords" content="statox blog"/><meta name="generator" content="Eleventy"/><meta property="og:title" content="The stuff I do"/><meta property="og:url" content="https://www.statox.fr"/><meta property="og:description" content="A personal blog where I write about my side projects"/><meta property="og:type" content="website"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#5bbad5"/><script>const bigScreenQuery=window.matchMedia("(max-width: 600px)");let bigScreen=!bigScreenQuery.matches;function navbarNavigate(e){var t=document.getElementById("header-navbar");(bigScreen||t.className.includes("responsive"))&&(document.location.pathname=e)}function navbarToggle(){var e=document.getElementById("header-navbar");"topnav"===e.className?e.className+=" responsive":e.className="topnav"}function toggleDarkTheme(){var e,t,n="1"===getComputedStyle(document.documentElement).getPropertyValue("--is-light-theme");const o=n?"-d":"-l";for({current:e,target:t}of["--nc-tx-1","--nc-tx-2","--nc-tx-3","--nc-bg-0","--nc-bg-1","--nc-bg-2","--nc-bg-3","--nc-lk-1","--nc-lk-2","--nc-lk-tx","--nc-ac-1","--nc-ac-tx"].map(e=>({current:e,target:e.slice(0,4)+o+e.slice(4)}))){var a=getComputedStyle(document.documentElement).getPropertyValue(t);document.documentElement.style.setProperty(e,a)}document.documentElement.style.setProperty("--is-light-theme",n?"0":"1"),writeLightThemeCookie(n?"0":"1")}function domReady(e){document.addEventListener("DOMContentLoaded",e),"interactive"!==document.readyState&&"complete"!==document.readyState||e()}function readLightThemeCookie(){return localStorage.getItem("lighttheme")}function writeLightThemeCookie(e){if("0"!==e&&"1"!==e)throw new Error("Invalid value for cookie lighttheme",e);localStorage.setItem("lighttheme",e)}bigScreenQuery.addListener(e=>bigScreen=!e.matches),domReady(()=>{var e=readLightThemeCookie();e&&getComputedStyle(document.documentElement).getPropertyValue("--is-light-theme")!==e&&toggleDarkTheme()})</script><style>/*!
 * new.css framework forked from https://github.com/xz/new.css
 */:root{--nc-font-sans:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--nc-font-mono:Consolas,monaco,"Ubuntu Mono","Liberation Mono","Courier New",Courier,monospace;--is-light-theme:1;--nc-l-tx-1:#000000;--nc-l-tx-2:#1a1a1a;--nc-l-tx-3:#6d7169;--nc-l-bg-0:#cecece;--nc-l-bg-1:#ffffff;--nc-l-bg-2:#f6f8fa;--nc-l-bg-3:#e5e7eb;--nc-l-lk-1:#0070f3;--nc-l-lk-2:#0366d6;--nc-l-lk-tx:#ffffff;--nc-l-ac-1:#79ffe1;--nc-l-ac-tx:#0c4047;--nc-d-tx-1:#ffffff;--nc-d-tx-2:#eeeeee;--nc-d-tx-3:#8a8d87;--nc-d-bg-0:#13191c;--nc-d-bg-1:#000000;--nc-d-bg-2:#111111;--nc-d-bg-3:#222222;--nc-d-lk-1:#3291ff;--nc-d-lk-2:#0070f3;--nc-d-lk-tx:#ffffff;--nc-d-ac-1:#7928ca;--nc-d-ac-tx:#ffffff;--nc-tx-1:var(--nc-l-tx-1);--nc-tx-2:var(--nc-l-tx-2);--nc-tx-3:var(--nc-l-tx-3);--nc-bg-0:var(--nc-l-bg-0);--nc-bg-1:var(--nc-l-bg-1);--nc-bg-2:var(--nc-l-bg-2);--nc-bg-3:var(--nc-l-bg-3);--nc-lk-1:var(--nc-l-lk-1);--nc-lk-2:var(--nc-l-lk-2);--nc-lk-tx:var(--nc-l-lk-tx);--nc-ac-1:var(--nc-l-ac-1);--nc-ac-tx:var(--nc-l-ac-tx)}@media (prefers-color-scheme:dark){:root{--is-light-theme:0;--nc-tx-1:var(--nc-d-tx-1);--nc-tx-2:var(--nc-d-tx-2);--nc-bg-0:var(--nc-d-bg-0);--nc-bg-1:var(--nc-d-bg-1);--nc-bg-2:var(--nc-d-bg-2);--nc-bg-3:var(--nc-d-bg-3);--nc-lk-1:var(--nc-d-lk-1);--nc-lk-2:var(--nc-d-lk-2);--nc-lk-tx:var(--nc-d-lk-tx);--nc-ac-1:var(--nc-d-ac-1);--nc-ac-tx:var(--nc-d-ac-tx)}}*{margin:0;padding:0}address,area,article,aside,audio,blockquote,datalist,details,dl,fieldset,figure,form,iframe,img,input,meter,nav,ol,optgroup,option,output,p,pre,progress,ruby,section,table,textarea,ul,video{margin-bottom:1rem}button,html,input,select{font-family:var(--nc-font-sans)}body{margin:0 auto;max-width:750px;padding:2rem;border-radius:6px;overflow-x:hidden;word-break:break-word;overflow-wrap:break-word;background:var(--nc-bg-1);color:var(--nc-tx-2);font-size:1.03rem;line-height:1.5}::selection{background:var(--nc-ac-1);color:var(--nc-ac-tx)}h1,h2,h3,h4,h5,h6{line-height:1;color:var(--nc-tx-1);padding-top:.875rem}h1,h2,h3{color:var(--nc-tx-1);padding-bottom:2px;margin-bottom:8px;border-bottom:1px solid var(--nc-bg-2)}h4,h5,h6{margin-bottom:.3rem}h1{font-size:2.25rem}h2{font-size:1.85rem}h3{font-size:1.55rem}h4{font-size:1.25rem}h5{font-size:1rem}h6{font-size:.875rem}a{color:var(--nc-lk-1)}a:hover{color:var(--nc-lk-2)}abbr:hover{cursor:help}blockquote{padding:1.5rem;background:var(--nc-bg-2);border-left:5px solid var(--nc-bg-3)}abbr{cursor:help}blockquote :last-child{padding-bottom:0;margin-bottom:0}header{background:var(--nc-bg-2);border-bottom:1px solid var(--nc-bg-3);padding:2rem 1.5rem;margin:-2rem calc(0px - (50vw - 50%)) 2rem;padding-left:calc(50vw - 50%);padding-right:calc(50vw - 50%)}header h1,header h2,header h3{padding-bottom:0;border-bottom:0}header>:first-child{margin-top:0;padding-top:0}header>:last-child{margin-bottom:0}a button,button,input[type=button],input[type=reset],input[type=submit]{font-size:1rem;display:inline-block;padding:6px 12px;text-align:center;text-decoration:none;white-space:nowrap;background:var(--nc-lk-1);color:var(--nc-lk-tx);border:0;border-radius:4px;box-sizing:border-box;cursor:pointer;color:var(--nc-lk-tx)}a button[disabled],button[disabled],input[type=button][disabled],input[type=reset][disabled],input[type=submit][disabled]{cursor:default;opacity:.5;cursor:not-allowed}.button:enabled:hover,.button:focus,button:enabled:hover,button:focus,input[type=button]:enabled:hover,input[type=button]:focus,input[type=reset]:enabled:hover,input[type=reset]:focus,input[type=submit]:enabled:hover,input[type=submit]:focus{background:var(--nc-lk-2)}code,kbd,pre,samp{font-family:var(--nc-font-mono)}code,kbd,pre,samp{background:var(--nc-bg-2);border:1px solid var(--nc-bg-3);border-radius:4px;padding:3px 6px;font-size:.9em}kbd{border-bottom:3px solid var(--nc-bg-3)}pre{padding:1rem 1.4rem;max-width:100%;overflow:auto}pre code{background:inherit;font-size:inherit;color:inherit;border:0;padding:0;margin:0}code pre{display:inline;background:inherit;font-size:inherit;color:inherit;border:0;padding:0;margin:0}details{padding:.6rem 1rem;background:var(--nc-bg-2);border:1px solid var(--nc-bg-3);border-radius:4px}summary{cursor:pointer;font-weight:700}details[open]{padding-bottom:.75rem}details[open] summary{margin-bottom:6px}details[open]>:last-child{margin-bottom:0}dt{font-weight:700}dd::before{content:"→ "}hr{border:0;border-bottom:1px solid var(--nc-bg-3);margin:1rem auto}fieldset{margin-top:1rem;padding:2rem;border:1px solid var(--nc-bg-3);border-radius:4px}legend{padding:auto .5rem}table{border-collapse:collapse;width:100%}td,th{text-align:left;padding:.5rem}th{font-weight:400;border-bottom:1px solid var(--nc-tx-1)}table caption{font-weight:700;margin-bottom:.5rem}textarea{max-width:100%}ol,ul{padding-left:2rem}li{margin-top:.4rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}mark{padding:3px 6px;background:var(--nc-ac-1);color:var(--nc-ac-tx)}input,select,textarea{padding:6px 12px;margin-bottom:.5rem;background:var(--nc-bg-2);color:var(--nc-tx-2);border:1px solid var(--nc-bg-3);border-radius:4px;box-shadow:none;box-sizing:border-box}img{max-width:100%}/*!
 * prism.js tomorrow night eighties for javascript, coffeescript, css and html
 * based on https://github.com/chriskempson/tomorrow-theme
 * Author: Rose Pritchard
 */code[class*=language-],pre[class*=language-]{color:#ccc;background:0 0;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}.formatted-tag{font-family:var(--nc-font-mono);opacity:.6}.not-found{text-align:center}#not-found-canvas{z-index:-1}a{text-decoration:none}pre{max-height:50rem}img{display:block;margin-left:auto;margin-right:auto}ul{list-style-type:circle}.header-anchor{font-size:small}.hidden{display:none}/*!
 * Inspired by material theme https://www.material-theme.com/docs/reference/color-palette/
 */:root{--is-light-theme:1;--nc-l-tx-1:#546e7a;--nc-l-tx-2:#161d21;--nc-l-tx-3:#6d7169;--nc-l-bg-1:#f4f4f4;--nc-l-bg-2:#eae8e8;--nc-l-bg-3:#fafafa;--nc-l-lk-1:#176166;--nc-l-lk-2:#528aff;--nc-l-lk-tx:#f3f4f5;--nc-l-ac-1:#91b859;--nc-l-ac-tx:#fafafa;--nc-d-tx-1:#ffffff;--nc-d-tx-2:#b7b7b7;--nc-d-tx-3:#8a8d87;--nc-d-bg-1:#1e272c;--nc-d-bg-2:#161d21;--nc-d-bg-3:#263238;--nc-d-lk-1:#5e92ff;--nc-d-lk-2:#99b2e8;--nc-d-lk-tx:#2e3c43;--nc-d-ac-1:#c3e88d;--nc-d-ac-tx:#263238}@media (prefers-color-scheme:dark){:root{--is-light-theme:0;--nc-tx-1:var(--nc-d-tx-1);--nc-tx-2:var(--nc-d-tx-2);--nc-tx-3:var(--nc-d-tx-3);--nc-bg-1:var(--nc-d-bg-1);--nc-bg-2:var(--nc-d-bg-2);--nc-bg-3:var(--nc-d-bg-3);--nc-lk-1:var(--nc-d-lk-1);--nc-lk-2:var(--nc-d-lk-2);--nc-lk-tx:var(--nc-d-lk-tx);--nc-ac-1:var(--nc-d-ac-1);--nc-ac-tx:var(--nc-d-ac-tx)}}.nav-link{text-decoration:none}.nav-link.active{color:var(--nc-lk-2)}.hamburger{width:20px;height:2px;box-shadow:inset 0 0 0 32px,0 -6px,0 6px;margin:16px 7px;display:block}.topnav .icon{display:none}@media screen and (max-width:600px){.topnav span.nav-item:not(.active){display:none}.topnav span.icon{float:right;display:block;right:0;top:0;color:var(--nc-lk-1)}.topnav .nav-separator{display:none}.topnav.responsive{position:relative}.topnav.responsive span.icon{position:absolute;right:0;top:0;color:var(--nc-lk-2)}.topnav.responsive span{float:none;display:block;text-align:left}.topnav.responsive span.nav-item:not(.active){display:block}}.comment{--comment-bg:#e3efee;--comment-d-bg:#2a4765;margin-top:20px;padding:5px}.add-comment-btn{float:right}.comment-header{background:var(--comment-bg);padding-right:100px;padding-left:10px;border-top-left-radius:10px;border-top-right-radius:10px;padding:5px}.comment-content{border:2px solid var(--comment-bg);border-bottom-left-radius:10px;border-bottom-right-radius:10px}.comment-text{padding:10px}.comment-reactions{border-top:2px solid var(--comment-bg);padding:5px}.comment-reaction-item{padding-right:10px;padding-left:10px;border-right:2px solid var(--comment-bg)}@media (prefers-color-scheme:dark){.comment{--comment-bg:var(--comment-d-bg)}}kbd{--black-800:#242729;--white:#fff;--black-075:#e4e6e8;--black-300:#9fa6ad;--s-prose-line-height:1.5;--ff-sans:Arial,"Helvetica Neue",Helvetica,sans-serif}@media (prefers-color-scheme:dark){kbd{--black-800:#e7e8eb;--white:#2d2d2d;--black-075:#404345;--black-300:#7d848d}}kbd{display:inline-block;margin:0 .1em;padding:.1em .6em;font-family:var(--nc-font-sans);font-size:11px;line-height:var(--s-prose-line-height);color:var(--black-800);text-shadow:0 1px 0 var(--white);background-color:var(--black-075);border:1px solid var(--black-300);border-radius:3px;box-shadow:0 1px 1px rgba(12,13,14,.15),inset 0 1px 0 0 #fff;overflow-wrap:break-word}.top-link{transition:all .25s ease-in-out;position:fixed;bottom:0;left:10;display:inline-flex;cursor:pointer;align-items:center;justify-content:center;margin:0 3em 3em 0;border-radius:50%;padding:.25em;width:40px;height:40px;background-color:var(--nc-bg-2)}.top-link.show{visibility:visible;opacity:1}.top-link.hide{visibility:hidden;opacity:0}.top-link svg{fill:var(--nc-lk-1);width:24px;height:12px}.top-link:hover{background-color:var(--nc-bg-0)}.top-link:hover svg{fill:var(--nc-lk-2)}.screen-reader-text{position:absolute;clip-path:inset(50%);margin:-1px;border:0;padding:0;width:1px;height:1px;overflow:hidden;word-wrap:normal!important;clip:rect(1px,1px,1px,1px)}.screen-reader-text:focus{display:block;top:5px;left:5px;z-index:100000;clip-path:none;background-color:#eee;padding:15px 23px 14px;width:auto;height:auto;text-decoration:none;line-height:normal;color:#444;font-size:1em;clip:auto!important}.disable-scrollbars::-webkit-scrollbar{background:0 0;width:0}.disable-scrollbars{scrollbar-width:none;-ms-overflow-style:none}.pull-right{float:right}.post-subheader{font-style:italic;color:var(--nc-tx-3)}.post-date{font-family:var(--nc-font-mono)}ul.post-list{list-style-type:none;padding-left:0}@media screen and (max-width:600px){.post-date{display:none}ul.post-list{list-style-type:disc;padding-left:0}}.post-date.no-date{display:none}ul.post-list.no-date{list-style-type:disc;padding-left:2rem}</style></head><body><header><h1>The stuff I do</h1><nav class="topnav" id="header-navbar" onclick="navbarToggle()"><span class="nav-item"><a class="nav-link" href="#" onclick='navbarNavigate("/")' data-goatcounter-click="navbar-Home" data-goatcounter-referrer="/posts/2024/06/station_meteo_maison/">Home</a> <i class="nav-separator">♢</i> </span><span class="nav-item"><a class="nav-link" href="#" onclick='navbarNavigate("/posts/")' data-goatcounter-click="navbar-Posts" data-goatcounter-referrer="/posts/2024/06/station_meteo_maison/">Posts</a> <i class="nav-separator">♢</i> </span><span class="nav-item"><a class="nav-link" href="#" onclick='navbarNavigate("/projects/")' data-goatcounter-click="navbar-Projects" data-goatcounter-referrer="/posts/2024/06/station_meteo_maison/">Projects</a> <i class="nav-separator">♢</i> </span><span class="nav-item"><a class="nav-link" href="#" onclick='navbarNavigate("/apps/")' data-goatcounter-click="navbar-Apps" data-goatcounter-referrer="/posts/2024/06/station_meteo_maison/">Apps</a> <i class="nav-separator">♢</i> </span><span class="nav-item"><a class="nav-link" href="#" onclick='navbarNavigate("/music/")' data-goatcounter-click="navbar-Music" data-goatcounter-referrer="/posts/2024/06/station_meteo_maison/">Music</a> <i class="nav-separator">♢</i> </span><span class="nav-item"><a class="nav-link" href="#" onclick='navbarNavigate("/about/")' data-goatcounter-click="navbar-About" data-goatcounter-referrer="/posts/2024/06/station_meteo_maison/">About</a> <i class="nav-separator">♢</i> </span><span class="nav-item"><a class="nav-link" href="#" onclick='navbarNavigate("/ring/")' data-goatcounter-click="navbar-Ring" data-goatcounter-referrer="/posts/2024/06/station_meteo_maison/">Ring</a> <i class="nav-separator">♢</i> </span><span class="nav-item"><a class="nav-link" href="#" onclick='navbarNavigate("/feed.xml")' data-goatcounter-click="navbar-RSS" data-goatcounter-referrer="/posts/2024/06/station_meteo_maison/">RSS</a> <i class="nav-separator">♢</i> </span><span style="cursor:pointer" class="nav-item" onclick="toggleDarkTheme()" data-goatcounter-click="toggle-theme" data-goatcounter-referrer="/posts/2024/06/station_meteo_maison/">◐</span> <span class="icon hamburger"></span></nav></header><div class="content-container"><h2>Capteurs environnementaux maison</h2><p class="post-subheader"><span id="post_date"></span> - 1576 words - <span id="commentCounter"></span> <span id="comment_word"></span></p><p><a href="/posts" data-goatcounter-click="back-to-posts" data-goatcounter-referrer="/posts/2024/06/station_meteo_maison/">← Posts</a></p><blockquote><p><em>This post is a copy-past of a personnal message sent to a relative to talk about my project. A more complete and technical version is available <a href="/posts/2024/06/environment_sensors/">here</a>.</em></p></blockquote><p>L'idée est de mettre en place des capteurs qui me remontent régulièrement la température et l'humidité des différentes pièces de l'appartement et de l'extérieur de l'appartement, de corréler ces données aux données de stations météo France autour de chez nous et de visualiser l'évolution de ces données au cours du temps. Le but est d'une part de mieux comprendre comment garder l'appartement le plus frais possible pendant les canicules, mais surtout de m'amuser avec de l'électronique et en apprendre plus sur la météorologie!</p><p>L'expérience débute avec la réalisation de capteurs environnementaux &quot;maison&quot;. D'abord la version la plus simple possible qui sera équipée de l'équivalent d'un <a href="https://learn.adafruit.com/adafruit-feather-huzzah-esp8266" target="_blank" rel="noopener noreferrer">arduino avec une puce wifi intégrée</a> connecté à un <a href="https://learn.adafruit.com/dht" target="_blank" rel="noopener noreferrer">capteur de température et d'humidité</a>. Un œil avisé remarquera trois résistances branchées entre le positif et la masse avec un fil qui part de l'une d'entre elle pour aller jusqu'au circuit, le lecteur électronicien identifiera peut être un pont diviseur de tension: le système est alimenté par une petite batterie LiPo (à gauche de la photo), ces batteries ayant une fâcheuse tendance à exploser quand leur charge atteint un niveau trop bas il est nécessaire de surveiller le niveau de charge. Mais les entrées analogiques du circuit ne supportant une tension maximale que de 1V et la batterie délivrant entre 4.2V et 3.3V dans sa zone de sécurité, on a besoin d'un pont diviseur pour ramener la tension de la batterie à une tension lisible par le circuit.</p><p><img src="./breadboard_dht11.jpg" alt="Breadboard DHT11"/></p><center><i>The early prototype: Breadboard version of ESP8266 reading from a DHT11</i></center><p>Une fois ce premier montage fonctionnant on se félicite de ne pas avoir fait exploser la batterie et on essaie d'exploiter la donnée du capteur: Pour ce faire le circuit va relever la température et l'humidité toutes les 10 minutes et utiliser sa puce wifi pour appeler un serveur. C'est un serveur sur lequel le créateur travaille depuis plusieurs mois et dont la dernière fonctionnalité implémentée par ses soins permet de recevoir un appel HTTP contenant des informations et de les enregistrer dans une base de donnée spécialement conçue pour contenir des données &quot;temporelles&quot; (qui évoluent avec le temps).</p><p>On passera au lecteur les détails techniques et on retiendra que l'on commence a obtenir des graphiques de ce genre représentant l'évolution de la température et de l'humidité et de la charge de la batterie au cours du temps. Le lecteur attentif remarquera que les données ne semblent pas significatives pour l'instant: Le capteur n'a pas fonctionné en continu pendant l'expérience, les manipulations ont faussé les valeurs de température et la charge de la batterie est notée au delà de 100%. Le créateur y verra néanmoins un début prometteur!</p><p><img src="./first_visualization.jpg" alt="First Kibana Visualization"/></p><center><i>The first Kibana visualization</i></center><p>Les étapes suivantes consisteront en deux avancées majeures: On passe du format &quot;planche d'expérimentation&quot; (breadboard) au format &quot;planche de prototypage&quot; (protoboard) qui s'enfiche directement sur les connections du circuit pour réduire l'encombrement du capteur. On remplacera également le capteur DHT11 par un capteur DHT22, qui a l'avantage d'être plus stable dans ses relevés, d'avoir une précision de température de ±0.5°C contre ±2°C pour l'ancien capteur DHT11, un plus large champ de relevés d'humidité (0-100% contre 20-80%) contre l'inconvénient de ne pouvoir donner des résultats significatifs que toutes les 2 secondes (contre une fréquence d’échantillonnage minimale de toutes les 1 secondes pour le DHT11) ce qui n'est pas un problème en soit vu que le système est conçu pour faire des relevés toutes les 10 minutes.</p><p><img src="./protoboard_dht22_1.jpg" alt="Protoboard version"/><br/><img src="./protoboard_dht22_2.jpg" alt="Protoboard version"/></p><center><i>Moving the project to a protoboard</i></center><p>On aura réalisé 2 capteurs similaires pour commencer a comparer la précision des capteurs industriels achetés et on se félicitera de voir que sur la période du 25 au 30 mai où les capteurs sont resté placés l'un à coté de l'autre les valeurs sont très similaires!</p><p><img src="./similar_curves_for_2_sensors.png" alt="Similar curves for two different sensors"/></p><center><i>Similar curves for two different sensors</i></center><p>À ce moment on commence à se poser la question du conditionnement des capteurs: Comment créer des boites qui permettent à la fois de protéger les capteurs des aléas d'un environnement ménager tout en leur permettant d'assurer au mieux leur fonction de relevés? Plusieurs pistes seront envisagées d'une part un collègue propose de mettre à disposition son imprimante 3d afin de créer des boites parfaitement adaptées au système, d'autre part le créateur envisage la conception de boites faites de pièces de Lego. Pour ce faire l'auteur fera ressortir ses anciens cours de dessin industriel et tentera de relever au mieux les cotes du projet. Néanmoins la partie de création de boites est pour l'instant à l’arrêt du fait d'un manque de temps pour relancer l'imprimante 3d et d'un créateur qui a remis à plus tard l'idée de maîtriser <a href="https://www.mecabricks.com/en/workshop" target="_blank" rel="noopener noreferrer">l'outil de conception d'assemblage de Lego</a> en 3d pour concevoir la boite uniquement depuis un ordinateur et sans pièces Lego à disposition.</p><p><img src="./sensor_quotes.jpg" alt="Sensor quotes"/></p><center><i>Handmade sensor quotes</i></center><p>À défaut de boite artisanales adaptées à l'environnement intérieur le créateur se lance ensuite dans la réalisation d'une boite &quot;weather-proof&quot; qui pourra accueillir le capteur en milieu extérieur, on s'appuiera alors sur un boîtier issu du commerce et équipé d'un joint torique dans lequel on réalisera une ouverture afin de faire passer un passe cable étanche. Le but étant d'assurer au circuit et à sa batterie un environnement à l'humidité stable tout en permettant au capteur d'être placé en extérieur afin de mesure au mieux son environnement:</p><p><img src="./weatherproof_enclosure.jpg" alt="Weather-proof enclosure"/><br/><img src="./weatherproof_enclosure_with_cable_gland.jpg" alt="Weather-proof enclosure with cable gland"/></p><center><i>Sensor in a weather-proof enclosure</i></center><p>Ce système sera testé via la méthode dite &quot;de la bonne grosse douche bien chaude&quot;: On placera le capteur dans son boîtier étanche (&quot;dev-sensor-2&quot; courbe bleue) dans une salle de bain pendant la douche du créateur pendant qu'un second capteur non protégé (&quot;dev-sensor&quot; courbe verte) sera placé derrière la porte de la-dite salle de bain . Le lecteur pourra observer que si le boîtier étanche ne protège pas le circuit des changements de températeurs (courbe de gauche) l'humidité à l'intérieur du boîtier, elle, reste constante quand l'humidité à l'extérieur de la salle de bain augmente significativement: Réussite notre boiter étanche est bien étanche!</p><p><img src="./weatherproof_enclosure_metrics.PNG" alt="Metrics in the weather-proof enclosure"/></p><center><i>Metrics in the weather-proof enclosure</i></center><p>La suite consiste désormais à intégrer <a href="https://whadda.com/product/bme280-temperature-humidity-and-pressure-sensor-wpse335/" target="_blank" rel="noopener noreferrer">un nouveau type de capteur</a> afin qu'une fois en extérieur les relevés puissent intégrer la pression atmosphérique, composante cruciale de la prévision météo. L'auteur profitera de l'occasion pour se documenter sur les systèmes météorologiques d'anticyclone, de dépression, de fonts chauds, froids et composites, des différents facteurs ayant une influence sur la pression atmosphérique, ainsi que sur les recommendations d'installations de stations météo amateur.</p><p>(En haut à gauche le nouveau capteur BME280 combinant pression, température et humidité -meme si 6 connections sont accessibles seulement 4 sont vraiment utilisées dans notre système-. L'ancien capteur DHT22 reste également connecté pour comparer les relevés)</p><p><img src="./protoboard_bme280.jpg" alt="Protoboard with BME280"/></p><center><i>Protoboard with BME280</i></center><p>En plus de ce nouveau capteur l'auteur aura pris soin d'incorporer à ses tableaux de mesures les informations fournies par les stations MétéoFrance installées dans Paris. En effet MétéoFrance met à la disposition du public un service permettant d'interroger ses bases de données en temps réel et de recevoir les mises à jour horaires de ses différentes stations. Toutes les stations ne renvoient pas les mêmes informations par exemple seulement Longchamp et Montsouris fournissent des relevés d'humidité:</p><p><img src="./meteo_france_metrics.png" alt="Meteo-France metrics"/></p><center><i>Meteo-France temperature and humidity</i></center><p>Sur le graph de gauche le lecteur avisé s'interrogera sûrement sur la station renvoyant une température constamment inférieure a toutes les autres: cette station est en fait située au sommet les 330 mètres de la Tour Eiffel, ce qui explique une température en moyenne 3 degrés inférieurs à l'ensemble des autres stations qui se situent en moyenne a 1m20 du sol.</p><p>On récupère également les niveaux de précipitations de certaines stations (On notera que ces données semblent toutes arrondies à l'entier le plus proche, une interrogation en cours pour l'auteur, plus de détails dans un prochain épisode)</p><p><img src="./meteo_france_precipitations.png" alt="Meteo-France precipitations"/></p><center><i>Meteo-France precipitations</i></center><p>Enfin on récupère la pression atmosphérique renvoyée uniquement par la stations de Montsouris (en jaune) et en la compare à la pression relevée par notre capteur maison. Le lecteur pourra s’enthousiasmer du niveau de précision du capteur qui suit de très près les variations de la station:</p><p><img src="./atmospheric_pressure.png" alt="Atmospheric pressure"/></p><center><i>Atmospheric pressure</i></center><p>Mais si les variations sont suivies de près on notera que les valeurs remontées ont un écart constant de 4hPa ce qui nous amène à la question cruciale du moment: Comment les capteurs sont-ils calibrés et comment mesurer compenser leur défaut s'il existe?</p><p>Prenons par exemple les mesures d'humidité:</p><p><img src="./humidity_with_error.png" alt="Humidity with error"/></p><center><i>Humidity with error</i></center><p>Nous avons en tout 3 capteurs: 2 DHT22 (courbe verte et courbe bleue) et 1 BME280 (courbe rose). À première vue les allures sont similaires mais on remarque que le BME280 à l'air d'avoir une erreur d'environ 4.8%, on peut donc tracer la courbe 4.8% plus haut mais on se rend compte alors que le capteur n'a peut être pas qu'un défaut de décalage mais aussi un défaut d'échelle: Pourquoi les pics roses sont-ils plus hauts que les pics verts et bleus?</p><p><img src="./humidity_correction_hypothesis.png" alt="Humidity correction hypothesis"/></p><center><i>Humidity correction hypothesis</i></center><p>Les resources en ligne décrivent des protocoles expérimentaux pour tenter de quantifier ce genres de décalages. Une méthode possible consiste à remplir une bouteille Thermos de glace pilée réalisée a partir d'eau déminéralisée pour atteindre une température exacte de zéro degrés et à partir de cette température connue observer les relevés des capteurs et en déduire le biais. Ce genre d'expériences pourraient bien occuper les prochains weekends du créateur, qui ne manquera pas de tenir son lecteur informé des évolutions du projet!</p><p><a href="/posts" data-goatcounter-click="back-to-posts" data-goatcounter-referrer="/posts/2024/06/station_meteo_maison/">← Posts</a></p><hr/><p></p><h3>Related posts</h3><p>Posts in the same category: <span class="formatted-tag">[weather]</span></p><ul><li><span class="post-date">Jun 2024</span> <a class="post-link" href="/posts/2024/06/environment_sensors/">Creating my homemade environmental sensors system</a></li></ul><hr/><comments><h3>Comments</h3><a class="add-comment-btn" href="https://github.com/statox/blog-comments/issues/38#new_comment_field" target="_blank" rel="noopener noreferrer"><button>Comment on Github</button></a><br/></comments><script>const reactionEmojis={laugh:"&#x1F600","+1":"&#x1F44D","-1":"&#x1F44E",hooray:"&#x1F389",confused:"&#x1F615",heart:"&#x2665",rocket:"&#x1F680",eyes:"&#x1F440"};function domReady(e){document.addEventListener("DOMContentLoaded",e),"interactive"!==document.readyState&&"complete"!==document.readyState||e()}function countReactions(e){const t={};return e.forEach(e=>{t[e.content]?t[e.content]++:t[e.content]=1}),t}function formatReactions(e){if(!e.length)return"";const n=countReactions(e);return Object.keys(n).reduce((e,t)=>{return e+'<span class="comment-reaction-item">'+(reactionEmojis[t]||`:${t}:`)+"&nbsp"+n[t]+"</span>"},"")}function appendComments(e){const o=document.querySelector("comments");var t=document.getElementById("commentCounter");t&&(t.innerText=e.length||0),e&&e.forEach&&0!==e.length?e.forEach(function(e){var t=formatCommentDate(new Date(e.created_at)),t=`<a href="${e.user.html_url} rel="noopener noreferrer" target="_blank">${e.user.login}</a>`+" on "+`<a href="${e.html_url}" rel="noopener noreferrer" target="_blank">${t}</a>`;let n="";n=(n=(n+='<div class="comment">')+'    <div class="comment-header">'+t+'</div>    <div class="comment-content">')+'        <div class="comment-text">'+e.body_html+"</div>",0<e.reactions.length&&(n+='        <div class="comment-reactions">'+formatReactions(e.reactions)+"</div>"),n+="    </div></div>",o.insertAdjacentHTML("beforeend",n)}):o.insertAdjacentHTML("beforeend","<p>No comments yet.</p>")}async function getComments(e){return(await fetch(`https://api.github.com/repos/statox/blog-comments/issues/${e}/comments`,{method:"GET",mode:"cors",cache:"no-cache",headers:{Accept:"application/vnd.github.v3.html+json"}})).json()}async function getReactions(e){return(await fetch(`https://api.github.com/repos/statox/blog-comments/issues/comments/${e}/reactions`,{method:"GET",mode:"cors",cache:"no-cache",headers:{Accept:"application/vnd.github.squirrel-girl-preview+json"}})).json()}function formatCommentDate(e){return e.getDate()+`/${e.getUTCMonth()+1}/`+e.getFullYear()}function setupCommentsInPage(t){domReady(async()=>{var e=await getComments(t);await Promise.all(e.map(async e=>{e.reactions=await getReactions(e.id)})),appendComments(e)})}function adaptToScreenSize(e){var t=new Date("Mon Jun 17 2024 00:00:00 GMT+0000 (Coordinated Universal Time)");let n=t.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}),o="comments";e.matches&&(n=t.toLocaleDateString(void 0,{year:"numeric",month:"numeric",day:"numeric"}),o="💬"),document.getElementById("post_date").textContent=n,document.getElementById("comment_word").textContent=o}setupCommentsInPage(38);var x=window.matchMedia("(max-width: 500px)");adaptToScreenSize(x),x.addListener(adaptToScreenSize)</script><a class="top-link hide" href="" id="js-top"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6"><path d="M12 6H0l6-6z"/></svg> <span class="screen-reader-text">Back to top</span></a><script>const scrollToTopButton=document.getElementById("js-top");let scrollTimer;const scrollFunc=()=>{var o=window.scrollY;scrollToTopButton.className=0<o?"top-link show":"top-link hide",scrollTimer&&clearTimeout(scrollTimer),scrollTimer=setTimeout(()=>{scrollToTopButton.className="top-link hide"},3e3)},scrollToTop=(window.addEventListener("scroll",scrollFunc),()=>{var o=document.documentElement.scrollTop||document.body.scrollTop;0<o&&(window.requestAnimationFrame(scrollToTop),window.scrollTo(0,o-o/2))});scrollToTopButton.onclick=function(o){o.preventDefault(),scrollToTop()}</script></div><script data-goatcounter="https://statoxblog.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/open-fonts@1.1.1/fonts/inter.min.css"/><script src="https://kit.fontawesome.com/cc32401bee.js" crossorigin="anonymous"></script></body></html>