---
layout: layouts/base.njk
templateClass: tmpl-post
---

<h2>{{ title }}</h2>
<p class="post-subheader">
    <span id="post_date"></span>
    - {{ content | wordCount }} words
    - <span id="commentCounter"></span> <span id="comment_word"></span>

</p>
<p><a href="{{ '/' | url }}">‚Üê Posts</a></p>

{{ content | safe }}

<p><a href="{{ '/' | url }}">‚Üê Posts</a></p>

{# Related posts section #}
{# TODO: Refactor that, this is not robust #}
<hr>
{% set currentTag = tags[1]  %}
{% set related = collections[currentTag] | relatedPosts(page) %}
<p>
<h3>Related posts</h3>
{% if related.length > 0 %}
<p>Posts in the same category: <span class='formatted-tag'>[{{currentTag}}]<span><p>
<ul>
    {%- for post in related -%}
        <li>
            <a class="post-link" href={{post.url}}>{{ post.title }}</a>
        </li>
    {%- endfor -%}
</ul>
<p>
{% else %}
<p>No other posts in the category <span class='formatted-tag'>[{{currentTag}}]<span></p>
{% endif %}

{# Comments section #}
<hr>
<comments>
    <h3>Comments</h3>
    <a class="add-comment-btn" href="https://github.com/statox/blog-comments/issues/{{commentIssueId}}#new_comment_field"  target="_blank" rel="noopener noreferrer">
        <button>Comment on Github</button>
    </a>
    <br>
</comments>

<script type="text/javascript" src="{{ '/scripts/githubComments.js' | url }}"></script>
<script type="text/javascript">
setupCommentsInPage({{commentIssueId}});

/* Use a media query to change the content of the interface for smaller screens */
function adaptToScreenSize(x) {
    const postDate = new Date('{{page.date}}');

    let datePostContent = postDate.toLocaleDateString(undefined,  { year: 'numeric', month: 'long', day: 'numeric' });
    let commentWordSpanContent = 'comments';

    if (x.matches) { // Small screens
        datePostContent = postDate.toLocaleDateString(undefined,  { year: 'numeric', month: 'numeric', day: 'numeric' });
        commentWordSpanContent = 'üí¨';
    }

    document.getElementById('post_date').textContent = datePostContent;
    document.getElementById('comment_word').textContent = commentWordSpanContent;
}

var x = window.matchMedia("(max-width: 500px)")
adaptToScreenSize(x) // Call listener function at run time
x.addListener(adaptToScreenSize) // Attach listener function on state changes 
</script>
